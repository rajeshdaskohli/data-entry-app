<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SM Sevadar NED</title>

  <style>
    body{ font-family: Arial, sans-serif; background:#f3f4f6; margin:0; padding:20px; }
    .card{ max-width:520px; margin:auto; background:#fff; padding:18px; border-radius:18px; box-shadow:0 6px 18px rgba(0,0,0,0.08); }
    h2{ margin:0 0 6px 0; font-size:22px; color: #16a34a; }
    .sub{ color:#6b7280; margin-bottom:14px; font-size:14px; }
    label{ font-weight:700; display:block; margin:12px 0 6px; }
    input, select{ width:100%; padding:12px; border:1px solid #d1d5db; border-radius:14px; font-size:16px; outline:none; box-sizing:border-box; background:#fff; }
    input:focus, select:focus{ border-color:#16a34a; box-shadow:0 0 0 3px rgba(22,163,74,0.15); }
    .btn{ width:100%; padding:14px; margin-top:16px; background:#16a34a; color:#fff; border:none; border-radius:14px; font-size:18px; font-weight:800; cursor:pointer; }
    .btn:disabled{ opacity:0.6; cursor:not-allowed; }
    .msg{ margin-top:12px; font-weight:700; text-align: center; }
    .pinBox{ margin-top:18px; padding-top:12px; border-top:1px solid #e5e7eb; }
    .smallBtn{ margin-top:10px; background:#111827; color:#fff; border:none; padding:10px 14px; border-radius:12px; font-weight:700; cursor:pointer; width: 100%; }
    #searchBox{ margin-top:14px; padding:12px; background:#f9fafb; border:1px solid #e5e7eb; border-radius:14px; }
    .resultItem{ background:#fff; border-left: 5px solid #16a34a; padding:12px; border-radius:8px; margin-top:10px; font-size:15px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
    .resName { font-weight: 800; color: #111827; }
    .resMob { color: #4b5563; font-size: 14px; }
  </style>
</head>

<body>
  <div class="card">
    <h2>üåç SM Sevadar NED</h2>
    <div class="sub">‡§®‡§æ‡§Æ, ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤, ‡§µ‡§ø‡§ß‡§æ‡§®‡§∏‡§≠‡§æ ‡§î‡§∞ ‡§è‡§∞‡§ø‡§Ø‡§æ ‡§≠‡§∞‡§ï‡§∞ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç‡•§</div>

    <label>‡§®‡§æ‡§Æ *</label>
    <input type="text" id="name" placeholder="‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ ‡§≤‡§ø‡§ñ‡•á‡§Ç" />

    <label>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï) *</label>
    <input type="text" id="mobile" placeholder="9876543210" maxlength="10" />

    <label>‡§µ‡§ø‡§ß‡§æ‡§®‡§∏‡§≠‡§æ</label>
    <select id="vidhansabha">
      <option value="">Select Vidhansabha</option>
      <option>Babarpur</option><option>Burari</option><option>Ghonda</option>
      <option>Gokalpur</option><option>Karawal Nagar</option><option>Mustafabad</option>
      <option>Rohtas Nagar</option><option>Seelampur</option><option>Seemapuri</option>
      <option>Timarpur</option>
    </select>

    <label>‡§è‡§∞‡§ø‡§Ø‡§æ</label>
    <input type="text" id="area" placeholder="Area" />

    <button id="saveBtn" class="btn" type="button" onclick="saveData()">‚úÖ Save Data</button>
    <div id="msg" class="msg"></div>

    <div class="pinBox">
      <label>Admin PIN (Search ‡§ï‡•á ‡§≤‡§ø‡§è)</label>
      <input type="password" id="adminPin" placeholder="PIN ‡§¶‡§∞‡•ç‡§ú ‡§ï‡§∞‡•á‡§Ç" />
      <button class="smallBtn" type="button" onclick="unlockSearch()">Unlock Search</button>

      <div id="searchBox" style="display:none;">
        <label>‡§ñ‡•ã‡§ú‡•á‡§Ç (‡§®‡§æ‡§Æ ‡§ï‡§æ ‡§™‡§π‡§≤‡§æ ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§Ø‡§æ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤)</label>
        <input type="text" id="search" placeholder="‡§ú‡•à‡§∏‡•á: R ‡§Ø‡§æ 98..." onkeyup="searchNow()" />
        <div id="results"></div>
      </div>
    </div>
  </div>

<script>
  // 1. ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ Apps Script Web App URL ‡§°‡§æ‡§≤‡•á‡§Ç
  const API_URL = "https://script.google.com/macros/s/AKfycbxmPmpMZFeMZoOO3B0m4oTQNsEFB3bhtkXkFk4pwmVZgrMQbZsZKjkFGNl_bTY1yhsN/exec";
  
  // 2. ‡§Ü‡§™‡§ï‡§æ ‡§è‡§°‡§Æ‡§ø‡§® ‡§™‡§ø‡§®
  const ADMIN_PIN = "7860";

  function setMsg(text, color){
    const msg = document.getElementById("msg");
    msg.innerHTML = text;
    msg.style.color = color || "black";
  }

  // ‡§°‡•á‡§ü‡§æ ‡§∏‡•á‡§µ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è
  async function saveData(){
    const name = document.getElementById("name").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const vidhansabha = document.getElementById("vidhansabha").value.trim();
    const area = document.getElementById("area").value.trim();

    if(!name || !mobile){
      setMsg("‚ö†Ô∏è ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à", "red");
      return;
    }

    const btn = document.getElementById("saveBtn");
    btn.disabled = true;
    btn.innerHTML = "‚è≥ Saving...";

    try{
      const res = await fetch(API_URL, {
        method: "POST",
        mode: "no-cors", // Apps Script POST ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ö‡§ï‡•ç‡§∏‡§∞ ‡•õ‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•ã‡§§‡§æ ‡§π‡•à
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({name, mobile, vidhansabha, area})
      });

      setMsg("‚úÖ ‡§°‡•á‡§ü‡§æ ‡§≠‡•á‡§ú ‡§¶‡§ø‡§Ø‡§æ ‡§ó‡§Ø‡§æ ‡§π‡•à!", "green");
      document.getElementById("name").value = "";
      document.getElementById("mobile").value = "";
      document.getElementById("area").value = "";
    }catch(e){
      setMsg("‚ùå ‡§è‡§∞‡§∞: " + e.message, "red");
    }
    btn.disabled = false;
    btn.innerHTML = "‚úÖ Save Data";
  }

  // ‡§∏‡§∞‡•ç‡§ö ‡§Ö‡§®‡§≤‡•â‡§ï ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è
  function unlockSearch(){
    const pin = document.getElementById("adminPin").value.trim();
    if(pin === ADMIN_PIN){
      document.getElementById("searchBox").style.display = "block";
      setMsg("üîì ‡§∏‡§∞‡•ç‡§ö ‡§Ö‡§®‡§≤‡•â‡§ï ‡§π‡•ã ‡§ó‡§Ø‡§æ", "green");
    }else{
      alert("‡§ó‡§≤‡§§ ‡§™‡§ø‡§®!");
    }
  }

  // ‡§ï‡•á‡§µ‡§≤ ‡§™‡§π‡§≤‡•á ‡§Ö‡§ï‡•ç‡§∑‡§∞ ‡§∏‡•á ‡§∏‡§∞‡•ç‡§ö ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è (API Call)
  async function searchNow(){
    const q = document.getElementById("search").value.trim().toLowerCase();
    const results = document.getElementById("results");
    
    if(q.length < 1){
      results.innerHTML = "";
      return;
    }

    try {
      const res = await fetch(`${API_URL}?action=search&q=${q}`);
      const data = await res.json();

      if(data.status === "success" && data.results.length > 0){
        results.innerHTML = data.results.map(item => `
          <div class="resultItem">
            <div class="resName">üë§ ${item.name}</div>
            <div class="resMob">üì± ${item.mobile}</div>
          </div>
        `).join('');
      } else {
        results.innerHTML = "<div style='padding:10px; font-size:13px;'>‡§ï‡•ã‡§à ‡§∞‡§ø‡§ï‡•â‡§∞‡•ç‡§° ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ‡•§</div>";
      }
    } catch(e) {
      console.log("Search error", e);
    }
  }
</script>
</body>
</html>
