<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SM Sevadar NED</title>

  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f3f4f6;
      margin:0;
      padding:20px;
    }
    .card{
      max-width:520px;
      margin:auto;
      background:#fff;
      padding:18px;
      border-radius:18px;
      box-shadow:0 6px 18px rgba(0,0,0,0.08);
    }
    h2{
      margin:0 0 6px 0;
      font-size:22px;
    }
    .sub{
      color:#6b7280;
      margin-bottom:14px;
      font-size:14px;
    }
    label{
      font-weight:700;
      display:block;
      margin:12px 0 6px;
    }
    input, select{
      width:100%;
      padding:12px;
      border:1px solid #d1d5db;
      border-radius:14px;
      font-size:16px;
      outline:none;
      box-sizing:border-box;
      background:#fff;
    }
    input:focus, select:focus{
      border-color:#16a34a;
      box-shadow:0 0 0 3px rgba(22,163,74,0.15);
    }
    .btn{
      width:100%;
      padding:14px;
      margin-top:16px;
      background:#16a34a;
      color:#fff;
      border:none;
      border-radius:14px;
      font-size:18px;
      font-weight:800;
      cursor:pointer;
    }
    .btn:disabled{
      opacity:0.6;
      cursor:not-allowed;
    }
    .msg{
      margin-top:12px;
      font-weight:700;
    }
    .pinBox{
      margin-top:18px;
      padding-top:12px;
      border-top:1px solid #e5e7eb;
    }
    .smallBtn{
      margin-top:10px;
      background:#111827;
      color:#fff;
      border:none;
      padding:10px 14px;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
    }
    #searchBox{
      margin-top:14px;
      padding:12px;
      background:#f9fafb;
      border:1px solid #e5e7eb;
      border-radius:14px;
    }
    .resultItem{
      background:#fff;
      border:1px solid #e5e7eb;
      padding:10px;
      border-radius:12px;
      margin-top:10px;
      font-size:14px;
    }
  </style>
</head>

<body>
  <div class="card">
    <h2>üåç SM Sevadar NED</h2>
    <div class="sub">‡§®‡§æ‡§Æ, ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤, ‡§µ‡§ø‡§ß‡§æ‡§®‡§∏‡§≠‡§æ ‡§î‡§∞ ‡§è‡§∞‡§ø‡§Ø‡§æ ‡§≠‡§∞‡§ï‡§∞ ‡§∏‡•á‡§µ ‡§ï‡§∞‡•á‡§Ç‡•§</div>

    <label>‡§®‡§æ‡§Æ *</label>
    <input type="text" id="name" placeholder="Name" />

    <label>‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ (10 ‡§Ö‡§Ç‡§ï) *</label>
    <input type="text" id="mobile" placeholder="Mobile" />

    <label>‡§µ‡§ø‡§ß‡§æ‡§®‡§∏‡§≠‡§æ</label>
    <select id="vidhansabha">
      <option value="">Select Vidhansabha</option>
      <option>Babarpur</option>
      <option>Burari</option>
      <option>Ghonda</option>
      <option>Gokalpur</option>
      <option>Karawal Nagar</option>
      <option>Mustafabad</option>
      <option>Rohtas Nagar</option>
      <option>Seelampur</option>
      <option>Seemapuri</option>
      <option>Timarpur</option>
    </select>

    <label>‡§è‡§∞‡§ø‡§Ø‡§æ</label>
    <input type="text" id="area" placeholder="Area" />

    <button id="saveBtn" class="btn" type="button" onclick="saveData()">‚úÖ Save</button>

    <div id="msg" class="msg"></div>

    <div class="pinBox">
      <label>Admin PIN (Search ‡§ï‡•á ‡§≤‡§ø‡§è)</label>
      <input type="password" id="adminPin" placeholder="Enter PIN" />
      <button class="smallBtn" type="button" onclick="unlockSearch()">Unlock Search</button>

      <div id="searchBox" style="display:none;">
        <label>Search (Name/Mobile starts with)</label>
        <input type="text" id="search" placeholder="‡§ú‡•à‡§∏‡•á: R / 9" onkeyup="searchNow()" />
        <div id="results"></div>
      </div>
    </div>
  </div>

<script>
  // üî• ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ Apps Script Web App /exec URL ‡§°‡§æ‡§≤‡•ã
  const API_URL = "https://script.google.com/macros/s/AKfycbybRB_rud3b6lkc_9n9oCIWQEa9Tb5wl9Q_TzgclpDa1nCFLNXZ0-JtY7I8hUHOIDFL/exec";

  // üî• ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ PIN ‡§∏‡•á‡§ü ‡§ï‡§∞‡•ã
  const ADMIN_PIN = "1326";

  function setMsg(text, color){
    const msg = document.getElementById("msg");
    msg.innerHTML = text;
    msg.style.color = color || "black";
  }

  async function saveData(){
    const name = document.getElementById("name").value.trim();
    const mobile = document.getElementById("mobile").value.trim();
    const vidhansabha = document.getElementById("vidhansabha").value.trim();
    const area = document.getElementById("area").value.trim();

    if(!name || !mobile){
      setMsg("‚ö†Ô∏è ‡§®‡§æ‡§Æ ‡§î‡§∞ ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§ú‡§∞‡•Ç‡§∞‡•Ä ‡§π‡•à", "red");
      return;
    }

    if(!/^[0-9]{10}$/.test(mobile)){
      setMsg("‚ö†Ô∏è ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ 10 ‡§Ö‡§Ç‡§ï ‡§ï‡§æ ‡§π‡•ã‡§®‡§æ ‡§ö‡§æ‡§π‡§ø‡§è", "red");
      return;
    }

    const btn = document.getElementById("saveBtn");
    btn.disabled = true;
    btn.innerHTML = "‚è≥ Saving...";

    try{
      const res = await fetch(API_URL, {
        method: "POST",
        headers: {"Content-Type":"text/plain;charset=utf-8"},
        body: JSON.stringify({name, mobile, vidhansabha, area})
      });

      const data = await res.json();

      if(data.status === "duplicate"){
        setMsg("‚ö†Ô∏è ‡§Ø‡§π ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç‡§¨‡§∞ ‡§™‡§π‡§≤‡•á ‡§∏‡•á ‡§Æ‡•å‡§ú‡•Ç‡§¶ ‡§π‡•à", "red");
      } else if(data.status === "success"){
        setMsg("‚úÖ Data Save ‡§π‡•ã ‡§ó‡§Ø‡§æ", "green");
        document.getElementById("name").value = "";
        document.getElementById("mobile").value = "";
        document.getElementById("area").value = "";
        document.getElementById("vidhansabha").value = "";
      } else {
        setMsg("‚ùå Error: " + (data.message || "Unknown"), "red");
      }
    }catch(e){
      setMsg("‚ùå ‡§®‡•á‡§ü‡§µ‡§∞‡•ç‡§ï/URL error", "red");
    }

    btn.disabled = false;
    btn.innerHTML = "‚úÖ Save";
  }

  function unlockSearch(){
    const pin = document.getElementById("adminPin").value.trim();

    if(pin === ADMIN_PIN){
      document.getElementById("searchBox").style.display = "block";
      setMsg("‚úÖ Search unlocked", "green");
    }else{
      document.getElementById("searchBox").style.display = "none";
      setMsg("‚ùå Wrong PIN", "red");
    }
  }

  // Search (Frontend ‡§Æ‡•á‡§Ç ‡§Ö‡§≠‡•Ä demo)
  function searchNow(){
    // ‡§Ö‡§≠‡•Ä search ‡§∏‡§ø‡§∞‡•ç‡§´ UI ‡§Æ‡•á‡§Ç ‡§π‡•à (‡§ö‡§æ‡§π‡•ã ‡§§‡•ã ‡§Æ‡•à‡§Ç API ‡§∏‡•á search ‡§≠‡•Ä ‡§ú‡•ã‡§°‡§º ‡§¶‡•Ç‡§Å)
    const q = document.getElementById("search").value.trim().toLowerCase();
    const results = document.getElementById("results");
    if(!q){
      results.innerHTML = "";
      return;
    }
    results.innerHTML = `<div class="resultItem">üîé ‡§Ü‡§™‡§®‡•á search ‡§ï‡§ø‡§Ø‡§æ: <b>${q}</b><br>(API search ‡§ú‡•ã‡§°‡§º‡§®‡§æ ‡§π‡•ã ‡§§‡•ã ‡§¨‡§§‡§æ‡§ì)</div>`;
  }
</script>

</body>
</html>
